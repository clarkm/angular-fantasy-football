<style></style>
<script src="angular.min.js"></script>
<script>
	var app = angular.module("searchPlayers", []);

	app.filter('searchFor', function () {
		return function (arr, searchString) {
			if(!searchString) {
				return arr;
			}
			var result = [];
			searchString = searchString.toLowerCase();
			angular.forEach(arr, function (player) {
				if (player.name.toLowerCase().indexOf(searchString) !== -1){
					result.push(player);
				}
			});
			return result
		};
	});

	app.filter('searchForPosition', function () {
		return function (arr, searchStringPosition) {
			if(!searchStringPosition) {
				return arr;
			}
			var result = [];
			searchStringPosition = searchStringPosition.toLowerCase();
			angular.forEach(arr, function (player) {
				if (player.position.toLowerCase().indexOf(searchStringPosition) !== -1){
					result.push(player);
				}
			});
			return result
		};
	});

	app.filter('searchForActive', function () {
		return function (arr, searchStringActive) {
			if(!searchStringActive) {
				return arr;
			}
			var result = [];
			searchStringActive = searchStringActive.toLowerCase();
			angular.forEach(arr, function (player) {
				if (player.active.toLowerCase().indexOf(searchStringActive) !== -1){
					result.push(player);
				}
			});
			return result
		};
	});

/*
	  var json = $http.get('aircraft.json').then(function(response) {
        $scope.avaliableAircraft = response.data;
        return response.data;
      });*/
	
	app.controller ('playersController',['$scope','$http', function ($scope,$http) {


		$scope.players = [];
		var json = $http.get('players.json').then(function (response) {
			document.player = response.data;
			$scope.players = response.data;
		});
		$scope.predicate = '-position';


		$scope.toggleActive = function (s) {
			s.active = !s.active;
		}
 
		$scope.total = function () {
			var total = 0;

			angular.forEach($scope.players, function (s) {
				if (s.active) {
					total+= s.value;
				}
			});
			return total;
		};

		$scope.teams = [];

		$scope.addTeam = function() {
		    $scope.teams.push({text:$scope.teamText, players:[]});
		    $scope.teamText = '';
		  };

		 $scope.archive = function(team) {
		 	var index = $scope.teams.indexOf(team);
		 	if (index != -1) {
		 		$scope.teams.splice(index,1);
		 	}

		  } 

		}
	])

	
</script>

<div ng-app="searchPlayers" ng-controller="playersController">

	<h2>Players</h2>

	search:
	<input type="text" ng-model="searchString" placeholder="Search Player Name" />
	<input type="text" ng-model="searchStringPosition" placeholder="Search Player Position" />
	<input type="checkbox" ng-model="searchStringActive" />

	<br />
	
	sort:
	<a href="#0" ng-click="predicate = 'position'; reverse=!reverse">Position</a>
	<a href="#0" ng-click="predicate = 'name'; reverse=!reverse">Name</a>
	<a href="#0" ng-click="predicate = 'value'; reverse=!reverse">Value</a>

	<ul>
		<li ng-repeat="player in players | searchFor:searchString | searchForPosition:searchStringPosition | searchForActive:searchStringActive | orderBy:predicate:reverse" ng-class="{active:player.active}">
		<input type="checkbox" checked ng-click="toggleActive(player)" />
			{{player.position}}: {{player.name}} <span>{{player.value}}</span> <button ng-click="draft(player)">Draft</button>
		</li>
	</ul>

	<div class="total">Total Value: {{total()}}</div>


	<form ng-submit="addTeam()">
        <input type="text" ng-model="teamText" size="30"
               placeholder="add team here">
        <input type="submit" value="add">
      </form>

      <ul>
        <li ng-repeat="team in teams">

          <span class="">{{team.text}}</span>
          <ul>
          	<li ng-repeat='player in team.players'>{{player.name}}</li>
          </ul>
          <button ng-click="archive(team)">delete?</button>
        </li>
      </ul>

</div>


